# SQL-Based-Natural-Assistant
# Gemini SQL Assistant — RCB Players (Repository README)

## Project Overview

This repository contains a small Streamlit app that uses Google Gemini (via `google-generativeai`) to convert natural language questions into **SQLite** queries and run them against a local `ipl_rcb_players2` database. It also includes a helper script to create and populate the SQLite database.

This project is ideal as a demo / learning sandbox for: LLM → SQL translation, RAG-free LLM-assisted DB exploration, and building simple Streamlit frontends.

---

## Contents / Repository Structure

```
├── app.py                # Streamlit app: LLM -> SQL -> SQLite -> results
├── sql.py                # Script to create & populate ipl_rcb_players2.db
├── ipl_rcb_players2.db   # (Optional) pre-built SQLite DB of RCB players
├── requirements.txt      # Python dependencies
└── README.md             # This file
```

---

## Features

* Convert plain-English user questions into SQLite queries using Gemini.
* Execute generated SQL on local SQLite DB and display results in a table.
* Optional: ask Gemini to explain the generated SQL.
* Simple example dataset for RCB (Royal Challengers Bangalore) players.

---

## Prerequisites

* Python 3.10+ (3.8+ likely works)
* `pip` available
* Google Gemini API credentials (set `GEMINI_API_KEY` in environment)

---

## Install / Setup

1. Clone the repository.

2. Create and activate a virtual environment (recommended):

```bash
python -m venv .venv
source .venv/bin/activate   # macOS / Linux
.\.venv\Scripts\activate  # Windows (PowerShell)
```

3. Install dependencies:

```bash
pip install -r requirements.txt
```

4. Add your Gemini API key to a `.env` file in the repository root:

```
GEMINI_API_KEY=sk-...your_key_here...
```

(Alternatively set the `GEMINI_API_KEY` environment variable in your shell.)

---

## How to create the database (sql.py)

If you don't have the `ipl_rcb_players2.db` file or want to recreate it from scratch, run:

```bash
python sql.py
```

`sql.py` will:

* Drop the table if it exists
* Create `ipl_rcb_players2` table with columns: `players_name`, `players_role`, `players_age`, `players_salary`
* Insert example records used by the app

After running, `ipl_rcb_players2.db` will be present in the same directory.

---

## Run the Streamlit app (app.py)

Start the app with:

```bash
streamlit run app.py
```

Then open the local Streamlit URL printed in your terminal (usually `http://localhost:8501`).

---

## Usage

* Type an English question in the input box, for example:

  * "List all players"
  * "Show only Batsmen"
  * "Who earns more than 300000?"
  * "Count of Allrounder?"
  * "Highest salary player?"

* Press **Run**. The app will:

  1. Send the prompt and question to Gemini to generate a SQL query.
  2. Display the generated SQL.
  3. Execute it against `ipl_rcb_players2.db` and show results.
  4. Optionally include an explanation of the SQL generated by Gemini.

**Note:** The app assumes a single table named `ipl_rcb_players2` with column names exactly as listed: `players_name`, `players_role`, `players_age`, `players_salary`.

---

## Security & Cost Notes

* The Gemini API is a paid service. Be mindful of usage and associated costs.
* Do **not** commit your `.env` file or API keys into source control. Add `.env` to `.gitignore`.
* This repo sends user text to a remote LLM. Avoid sending sensitive or private data.

---

## Troubleshooting

* **`ModuleNotFoundError: No module named 'google'`** — run `pip install -r requirements.txt`.
* **SQLite errors** — confirm the database file name is `ipl_rcb_players2.db` and is accessible.
* **Gemini authorization errors** — ensure `GEMINI_API_KEY` is set correctly and the key is valid.
* **Empty SQL or invalid SQL generated** — the LLM may sometimes produce malformed text; check the generated SQL block in the UI and adjust your question for clarity.

---

## Development / Contributing

This is a small demo project. Contributions are welcome — open an issue or PR for bug fixes, feature requests, or improved prompts.

Suggested improvements:

* Add authentication to the Streamlit app for safer demos.
* Support more than one table and schema discovery.
* Add unit tests for SQL execution and input sanitization.

---

## License

This project is provided as-is for learning/demo purposes. Add a license of your choice (e.g., MIT) before publishing.

---

# Per-file README: `app.py` (Detailed)

## Purpose

`app.py` is a Streamlit front-end that:

* Accepts English questions from a user
* Uses a handcrafted multi-part prompt to instruct Gemini to return a SQLite SQL query
* Runs that SQL on a local `ipl_rcb_players2.db`
* Displays the SQL, results, and an optional Gemini-provided explanation

## Important implementation notes

* The app uses `google.generativeai` (Gemini) and a `GEMINI_API_KEY` stored in `.env`.
* The prompt enforces constraints: SQLite syntax only, no semicolons/backticks, and a specific schema.
* The generated SQL is executed directly against SQLite. The repo is intended as a demo; **do not** run it against production databases without extra sanitization.

## How the SQL is generated

`get_gemini_sql(question, prompt)` calls the `gemini-2.0-flash` model and asks it to return the SQL. The app strips triple backticks if present and runs the SQL.

---

# Per-file README: `sql.py` (Detailed)

## Purpose

`sql.py` is a small script to create and populate the `ipl_rcb_players2` SQLite table used by the Streamlit app. It is intentionally minimal and written for educational/demo usage.

## Notes

* Running `python sql.py` will overwrite the table if it exists.
* The script uses `sqlite3` from the Python stdlib.
* Data values are hard-coded insert statements for example players.

---

## `requirements.txt` explanation

```
streamlit
google-generativeai
python-dotenv
sqlite3
```

`sqlite3` is part of the Python standard library (in many distributions), but you can leave it in `requirements.txt` for clarity. Installing `google-generativeai` requires you to follow Google/SDK installation guidance if additional system dependencies are needed.

---

## Example queries and expected SQL (examples from the prompt)

* Q: `List all players.`

  * SQL: `SELECT * FROM ipl_rcb_players2`

* Q: `Show only Batsmen.`

  * SQL: `SELECT * FROM ipl_rcb_players2 WHERE players_role = 'Batsmen'`

* Q: `Who earns the highest salary?`

  * SQL: `SELECT * FROM ipl_rcb_players2 ORDER BY players_salary DESC LIMIT 1`

---

## Contact

If you want improvements or help adapting this to a different dataset, open an issue or message the repo owner.

---

*README created for repository and per-file guidance.*
